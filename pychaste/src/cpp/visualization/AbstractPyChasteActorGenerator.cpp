/*

Copyright (c) 2005-2024, University of Oxford.
All rights reserved.

University of Oxford means the Chancellor, Masters and Scholars of the
University of Oxford, having an administrative office at Wellington
Square, Oxford OX1 2JD, UK.

This file is part of Chaste.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:
 * Redistributions of source code must retain the above copyright notice,
   this list of conditions and the following disclaimer.
 * Redistributions in binary form must reproduce the above copyright notice,
   this list of conditions and the following disclaimer in the documentation
   and/or other materials provided with the distribution.
 * Neither the name of the University of Oxford nor the names of its
   contributors may be used to endorse or promote products derived from this
   software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE
LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE
GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT
OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

*/

#include <boost/lexical_cast.hpp>
#include <vtkActor.h>
#include <vtkCell.h>
#include <vtkCubeAxesActor2D.h>
#include <vtkExtractEdges.h>
#include <vtkFeatureEdges.h>
#include <vtkGeometryFilter.h>
#include <vtkGlyph2D.h>
#include <vtkGlyph3D.h>
#include <vtkIdList.h>
#include <vtkImageData.h>
#include <vtkNamedColors.h>
#include <vtkPoints.h>
#include <vtkPolyData.h>
#include <vtkPolyDataMapper.h>
#include <vtkPolygon.h>
#include <vtkProperty.h>
#include <vtkSphereSource.h>
#include <vtkTubeFilter.h>
#include <vtkUnsignedCharArray.h>
#include <vtkUnstructuredGrid.h>
#include "Exception.hpp"
#include "UblasIncludes.hpp"
#include "UblasVectorInclude.hpp"

#include "AbstractPyChasteActorGenerator.hpp"

template <unsigned DIM>
AbstractPyChasteActorGenerator<DIM>::AbstractPyChasteActorGenerator()
        : mpColorTransferFunction(vtkSmartPointer<vtkColorTransferFunction>::New()),
          mpDiscreteColorTransferFunction(vtkSmartPointer<vtkColorTransferFunction>::New()),
          mShowEdges(true),
          mShowPoints(false),
          mShowVolume(true),
          mEdgeColor(zero_vector<double>(3)),
          mPointColor(unit_vector<double>(3, 2)),
          mVolumeColor(unit_vector<double>(3, 0)),
          mVolumeOpacity(0.9),
          mPointSize(0.5),
          mEdgeSize(0.01),
          mDataLabel(),
          mpScaleBar(vtkSmartPointer<vtkScalarBarActor>::New()),
          mShowScaleBar(false)
{
    mPointColor *= 255.0;
    mVolumeColor *= 255.0;

    double viridis_colors[256][3] = { { 0.0267004, 0.004874, 0.329415 },
                                      { 0.0268510, 0.009605, 0.335427 },
                                      { 0.0269944, 0.014625, 0.341379 },
                                      { 0.0271305, 0.019942, 0.347269 },
                                      { 0.0272594, 0.025563, 0.353093 },
                                      { 0.0273809, 0.031497, 0.358853 },
                                      { 0.0274952, 0.037752, 0.364543 },
                                      { 0.0276022, 0.044167, 0.370164 },
                                      { 0.0277018, 0.050344, 0.375715 },
                                      { 0.0277941, 0.056324, 0.381191 },
                                      { 0.0278791, 0.062145, 0.386592 },
                                      { 0.0279566, 0.067836, 0.391917 },
                                      { 0.0280267, 0.073417, 0.397163 },
                                      { 0.0280894, 0.078907, 0.402329 },
                                      { 0.0281446, 0.084320, 0.407414 },
                                      { 0.0281924, 0.089666, 0.412415 },
                                      { 0.0282327, 0.094955, 0.417331 },
                                      { 0.0282656, 0.100196, 0.422160 },
                                      { 0.0282910, 0.105393, 0.426902 },
                                      { 0.0283091, 0.110553, 0.431554 },
                                      { 0.0283197, 0.115680, 0.436115 },
                                      { 0.0283229, 0.120777, 0.440584 },
                                      { 0.0283187, 0.125848, 0.444960 },
                                      { 0.0283072, 0.130895, 0.449241 },
                                      { 0.0282884, 0.135920, 0.453427 },
                                      { 0.0282623, 0.140926, 0.457517 },
                                      { 0.0282290, 0.145912, 0.461510 },
                                      { 0.0281887, 0.150881, 0.465405 },
                                      { 0.0281412, 0.155834, 0.469201 },
                                      { 0.0280868, 0.160771, 0.472899 },
                                      { 0.0280255, 0.165693, 0.476498 },
                                      { 0.0279574, 0.170599, 0.479997 },
                                      { 0.0278826, 0.175490, 0.483397 },
                                      { 0.0278012, 0.180367, 0.486697 },
                                      { 0.0277134, 0.185228, 0.489898 },
                                      { 0.0276194, 0.190074, 0.493001 },
                                      { 0.0275191, 0.194905, 0.496005 },
                                      { 0.0274128, 0.199721, 0.498911 },
                                      { 0.0273006, 0.204520, 0.501721 },
                                      { 0.0271828, 0.209303, 0.504434 },
                                      { 0.0270595, 0.214069, 0.507052 },
                                      { 0.0269308, 0.218818, 0.509577 },
                                      { 0.0267968, 0.223549, 0.512008 },
                                      { 0.0266580, 0.228262, 0.514349 },
                                      { 0.0265145, 0.232956, 0.516599 },
                                      { 0.0263663, 0.237631, 0.518762 },
                                      { 0.0262138, 0.242286, 0.520837 },
                                      { 0.0260571, 0.246922, 0.522828 },
                                      { 0.0258965, 0.251537, 0.524736 },
                                      { 0.0257322, 0.256130, 0.526563 },
                                      { 0.0255645, 0.260703, 0.528312 },
                                      { 0.0253935, 0.265254, 0.529983 },
                                      { 0.0252194, 0.269783, 0.531579 },
                                      { 0.0250425, 0.274290, 0.533103 },
                                      { 0.0248629, 0.278775, 0.534556 },
                                      { 0.0246811, 0.283237, 0.535941 },
                                      { 0.0244972, 0.287675, 0.537260 },
                                      { 0.0243113, 0.292092, 0.538516 },
                                      { 0.0241237, 0.296485, 0.539709 },
                                      { 0.0239346, 0.300855, 0.540844 },
                                      { 0.0237441, 0.305202, 0.541921 },
                                      { 0.0235526, 0.309527, 0.542944 },
                                      { 0.0233603, 0.313828, 0.543914 },
                                      { 0.0231674, 0.318106, 0.544834 },
                                      { 0.0229739, 0.322361, 0.545706 },
                                      { 0.0227802, 0.326594, 0.546532 },
                                      { 0.0225863, 0.330805, 0.547314 },
                                      { 0.0223925, 0.334994, 0.548053 },
                                      { 0.0221989, 0.339161, 0.548752 },
                                      { 0.0220057, 0.343307, 0.549413 },
                                      { 0.0218130, 0.347432, 0.550038 },
                                      { 0.0216210, 0.351535, 0.550627 },
                                      { 0.0214298, 0.355619, 0.551184 },
                                      { 0.0212395, 0.359683, 0.551710 },
                                      { 0.0210503, 0.363727, 0.552206 },
                                      { 0.0208623, 0.367752, 0.552675 },
                                      { 0.0206756, 0.371758, 0.553117 },
                                      { 0.0204903, 0.375746, 0.553533 },
                                      { 0.0203063, 0.379716, 0.553925 },
                                      { 0.0201239, 0.383670, 0.554294 },
                                      { 0.0199430, 0.387607, 0.554642 },
                                      { 0.0197636, 0.391528, 0.554969 },
                                      { 0.0195860, 0.395433, 0.555276 },
                                      { 0.0194100, 0.399323, 0.555565 },
                                      { 0.0192357, 0.403199, 0.555836 },
                                      { 0.0190631, 0.407061, 0.556089 },
                                      { 0.0188923, 0.410910, 0.556326 },
                                      { 0.0187231, 0.414746, 0.556547 },
                                      { 0.0185556, 0.418570, 0.556753 },
                                      { 0.0183898, 0.422383, 0.556944 },
                                      { 0.0182256, 0.426184, 0.557120 },
                                      { 0.0180629, 0.429975, 0.557282 },
                                      { 0.0179019, 0.433756, 0.557430 },
                                      { 0.0177423, 0.437527, 0.557565 },
                                      { 0.0175841, 0.441290, 0.557685 },
                                      { 0.0174274, 0.445044, 0.557792 },
                                      { 0.0172719, 0.448791, 0.557885 },
                                      { 0.0171176, 0.452530, 0.557965 },
                                      { 0.0169646, 0.456262, 0.558030 },
                                      { 0.0168126, 0.459988, 0.558082 },
                                      { 0.0166617, 0.463708, 0.558119 },
                                      { 0.0165117, 0.467423, 0.558141 },
                                      { 0.0163625, 0.471133, 0.558148 },
                                      { 0.0162142, 0.474838, 0.558140 },
                                      { 0.0160665, 0.478540, 0.558115 },
                                      { 0.0159194, 0.482237, 0.558073 },
                                      { 0.0157729, 0.485932, 0.558013 },
                                      { 0.0156270, 0.489624, 0.557936 },
                                      { 0.0154815, 0.493313, 0.557840 },
                                      { 0.0153364, 0.497000, 0.557724 },
                                      { 0.0151918, 0.500685, 0.557587 },
                                      { 0.0150476, 0.504369, 0.557430 },
                                      { 0.0149039, 0.508051, 0.557250 },
                                      { 0.0147607, 0.511733, 0.557049 },
                                      { 0.0146180, 0.515413, 0.556823 },
                                      { 0.0144759, 0.519093, 0.556572 },
                                      { 0.0143343, 0.522773, 0.556295 },
                                      { 0.0141935, 0.526453, 0.555991 },
                                      { 0.0140536, 0.530132, 0.555659 },
                                      { 0.0139147, 0.533812, 0.555298 },
                                      { 0.0137770, 0.537492, 0.554906 },
                                      { 0.0136408, 0.541173, 0.554483 },
                                      { 0.0135066, 0.544853, 0.554029 },
                                      { 0.0133743, 0.548535, 0.553541 },
                                      { 0.0132444, 0.552216, 0.553018 },
                                      { 0.0131172, 0.555899, 0.552459 },
                                      { 0.0129933, 0.559582, 0.551864 },
                                      { 0.0128729, 0.563265, 0.551229 },
                                      { 0.0127568, 0.566949, 0.550556 },
                                      { 0.0126453, 0.570633, 0.549841 },
                                      { 0.0125394, 0.574318, 0.549086 },
                                      { 0.0124395, 0.578002, 0.548287 },
                                      { 0.0123463, 0.581687, 0.547445 },
                                      { 0.0122606, 0.585371, 0.546557 },
                                      { 0.0121831, 0.589055, 0.545623 },
                                      { 0.0121148, 0.592739, 0.544641 },
                                      { 0.0120565, 0.596422, 0.543611 },
                                      { 0.0120092, 0.600104, 0.542530 },
                                      { 0.0119738, 0.603785, 0.541400 },
                                      { 0.0119512, 0.607464, 0.540218 },
                                      { 0.0119423, 0.611141, 0.538982 },
                                      { 0.0119483, 0.614817, 0.537692 },
                                      { 0.0119699, 0.618490, 0.536347 },
                                      { 0.0120081, 0.622161, 0.534946 },
                                      { 0.0120638, 0.625828, 0.533488 },
                                      { 0.0121380, 0.629492, 0.531973 },
                                      { 0.0122312, 0.633153, 0.530398 },
                                      { 0.0123444, 0.636809, 0.528763 },
                                      { 0.0124780, 0.640461, 0.527068 },
                                      { 0.0126326, 0.644107, 0.525311 },
                                      { 0.0128087, 0.647749, 0.523491 },
                                      { 0.0130067, 0.651384, 0.521608 },
                                      { 0.0132268, 0.655014, 0.519661 },
                                      { 0.0134692, 0.658636, 0.517649 },
                                      { 0.0137339, 0.662252, 0.515571 },
                                      { 0.0140210, 0.665859, 0.513427 },
                                      { 0.0143303, 0.669459, 0.511215 },
                                      { 0.0146616, 0.673050, 0.508936 },
                                      { 0.0150148, 0.676631, 0.506589 },
                                      { 0.0153894, 0.680203, 0.504172 },
                                      { 0.0157851, 0.683765, 0.501686 },
                                      { 0.0162016, 0.687316, 0.499129 },
                                      { 0.0166383, 0.690856, 0.496502 },
                                      { 0.0170948, 0.694384, 0.493803 },
                                      { 0.0175707, 0.697900, 0.491033 },
                                      { 0.0180653, 0.701402, 0.488189 },
                                      { 0.0185783, 0.704891, 0.485273 },
                                      { 0.0191090, 0.708366, 0.482284 },
                                      { 0.0196571, 0.711827, 0.479221 },
                                      { 0.0202219, 0.715272, 0.476084 },
                                      { 0.0208030, 0.718701, 0.472873 },
                                      { 0.0214000, 0.722114, 0.469588 },
                                      { 0.0220124, 0.725509, 0.466226 },
                                      { 0.0226397, 0.728888, 0.462789 },
                                      { 0.0232815, 0.732247, 0.459277 },
                                      { 0.0239374, 0.735588, 0.455688 },
                                      { 0.0246070, 0.738910, 0.452024 },
                                      { 0.0252899, 0.742211, 0.448284 },
                                      { 0.0259857, 0.745492, 0.444467 },
                                      { 0.0266941, 0.748751, 0.440573 },
                                      { 0.0274149, 0.751988, 0.436601 },
                                      { 0.0281477, 0.755203, 0.432552 },
                                      { 0.0288921, 0.758394, 0.428426 },
                                      { 0.0296479, 0.761561, 0.424223 },
                                      { 0.0304148, 0.764704, 0.419943 },
                                      { 0.0311925, 0.767822, 0.415586 },
                                      { 0.0319809, 0.770914, 0.411152 },
                                      { 0.0327796, 0.773980, 0.406640 },
                                      { 0.0335885, 0.777018, 0.402049 },
                                      { 0.0344074, 0.780029, 0.397381 },
                                      { 0.0352360, 0.783011, 0.392636 },
                                      { 0.0360741, 0.785964, 0.387814 },
                                      { 0.0369214, 0.788888, 0.382914 },
                                      { 0.0377779, 0.791781, 0.377939 },
                                      { 0.0386433, 0.794644, 0.372886 },
                                      { 0.0395174, 0.797475, 0.367757 },
                                      { 0.0404001, 0.800275, 0.362552 },
                                      { 0.0412913, 0.803041, 0.357269 },
                                      { 0.0421908, 0.805774, 0.351910 },
                                      { 0.0430983, 0.808473, 0.346476 },
                                      { 0.0440137, 0.811138, 0.340967 },
                                      { 0.0449368, 0.813768, 0.335384 },
                                      { 0.0458674, 0.816363, 0.329727 },
                                      { 0.0468053, 0.818921, 0.323998 },
                                      { 0.0477504, 0.821444, 0.318195 },
                                      { 0.0487026, 0.823929, 0.312321 },
                                      { 0.0496615, 0.826376, 0.306377 },
                                      { 0.0506271, 0.828786, 0.300362 },
                                      { 0.0515992, 0.831158, 0.294279 },
                                      { 0.0525776, 0.833491, 0.288127 },
                                      { 0.0535621, 0.835785, 0.281908 },
                                      { 0.0545524, 0.838039, 0.275626 },
                                      { 0.0555484, 0.840254, 0.269281 },
                                      { 0.0565498, 0.842430, 0.262877 },
                                      { 0.0575563, 0.844566, 0.256415 },
                                      { 0.0585678, 0.846661, 0.249897 },
                                      { 0.0595839, 0.848717, 0.243329 },
                                      { 0.0606045, 0.850733, 0.236712 },
                                      { 0.0616293, 0.852709, 0.230052 },
                                      { 0.0626579, 0.854645, 0.223353 },
                                      { 0.0636902, 0.856542, 0.216620 },
                                      { 0.0647257, 0.858400, 0.209861 },
                                      { 0.0657642, 0.860219, 0.203082 },
                                      { 0.0668054, 0.861999, 0.196293 },
                                      { 0.0678489, 0.863742, 0.189503 },
                                      { 0.0688944, 0.865448, 0.182725 },
                                      { 0.0699415, 0.867117, 0.175971 },
                                      { 0.0709898, 0.868751, 0.169257 },
                                      { 0.0720391, 0.870350, 0.162603 },
                                      { 0.0730889, 0.871916, 0.156029 },
                                      { 0.0741388, 0.873449, 0.149561 },
                                      { 0.0751884, 0.874951, 0.143228 },
                                      { 0.0762373, 0.876424, 0.137064 },
                                      { 0.0772852, 0.877868, 0.131109 },
                                      { 0.0783315, 0.879285, 0.125405 },
                                      { 0.0793760, 0.880678, 0.120005 },
                                      { 0.0804182, 0.882046, 0.114965 },
                                      { 0.0814576, 0.883393, 0.110347 },
                                      { 0.0824940, 0.884720, 0.106217 },
                                      { 0.0835270, 0.886029, 0.102646 },
                                      { 0.0845561, 0.887322, 0.099702 },
                                      { 0.0855810, 0.888601, 0.097452 },
                                      { 0.0866013, 0.889868, 0.095953 },
                                      { 0.0876168, 0.891125, 0.095250 },
                                      { 0.0886271, 0.892374, 0.095374 },
                                      { 0.0896320, 0.893616, 0.096335 },
                                      { 0.0906311, 0.894855, 0.098125 },
                                      { 0.0916242, 0.896091, 0.100717 },
                                      { 0.0926106, 0.897330, 0.104071 },
                                      { 0.0935904, 0.898570, 0.108131 },
                                      { 0.0945636, 0.899815, 0.112838 },
                                      { 0.0955300, 0.901065, 0.118128 },
                                      { 0.0964894, 0.902323, 0.123941 },
                                      { 0.0974417, 0.903590, 0.130215 },
                                      { 0.0983868, 0.904867, 0.136897 },
                                      { 0.0993248, 0.906157, 0.143936 } };

    for (unsigned idx = 0; idx < 256; idx++)
    {
        mpColorTransferFunction->AddRGBPoint(double(idx) / 255.0,
                                             viridis_colors[idx][0],
                                             viridis_colors[idx][1],
                                             viridis_colors[idx][2]);
    }

    double accent_colors[256][3] = {
        { 0.498039215803, 0.78823530674, 0.498039215803 },
        { 0.504821223137, 0.785328732519, 0.507189542873 },
        { 0.511603230472, 0.782422158297, 0.516339869943 },
        { 0.518385237806, 0.779515584076, 0.525490197013 },
        { 0.52516724514, 0.776609009855, 0.534640524083 },
        { 0.531949252475, 0.773702435634, 0.543790851154 },
        { 0.538731259809, 0.770795861412, 0.552941178224 },
        { 0.545513267143, 0.767889287191, 0.562091505294 },
        { 0.552295274477, 0.76498271297, 0.571241832364 },
        { 0.559077281812, 0.762076138749, 0.580392159434 },
        { 0.565859289146, 0.759169564528, 0.589542486504 },
        { 0.57264129648, 0.756262990306, 0.598692813574 },
        { 0.579423303814, 0.753356416085, 0.607843140644 },
        { 0.586205311149, 0.750449841864, 0.616993467714 },
        { 0.592987318483, 0.747543267643, 0.626143794784 },
        { 0.599769325817, 0.744636693422, 0.635294121854 },
        { 0.606551333152, 0.7417301192, 0.644444448925 },
        { 0.613333340486, 0.738823544979, 0.653594775995 },
        { 0.62011534782, 0.735916970758, 0.662745103065 },
        { 0.626897355154, 0.733010396537, 0.671895430135 },
        { 0.633679362489, 0.730103822315, 0.681045757205 },
        { 0.640461369823, 0.727197248094, 0.690196084275 },
        { 0.647243377157, 0.724290673873, 0.699346411345 },
        { 0.654025384492, 0.721384099652, 0.708496738415 },
        { 0.660807391826, 0.718477525431, 0.717647065485 },
        { 0.66758939916, 0.715570951209, 0.726797392555 },
        { 0.674371406494, 0.712664376988, 0.735947719625 },
        { 0.681153413829, 0.709757802767, 0.745098046695 },
        { 0.687935421163, 0.706851228546, 0.754248373766 },
        { 0.694717428497, 0.703944654324, 0.763398700836 },
        { 0.701499435832, 0.701038080103, 0.772549027906 },
        { 0.708281443166, 0.698131505882, 0.781699354976 },
        { 0.7150634505, 0.695224931661, 0.790849682046 },
        { 0.721845457834, 0.69231835744, 0.800000009116 },
        { 0.728627465169, 0.689411783218, 0.809150336186 },
        { 0.735409472503, 0.686505208997, 0.818300663256 },
        { 0.742191479837, 0.683598634776, 0.827450990326 },
        { 0.748973486704, 0.68346022648, 0.826574404801 },
        { 0.75575549322, 0.685397942627, 0.818177634828 },
        { 0.762537499736, 0.687335658775, 0.809780864856 },
        { 0.769319506253, 0.689273374922, 0.801384094883 },
        { 0.776101512769, 0.69121109107, 0.792987324911 },
        { 0.782883519285, 0.693148807217, 0.784590554939 },
        { 0.789665525801, 0.695086523365, 0.776193784966 },
        { 0.796447532317, 0.697024239512, 0.767797014994 },
        { 0.803229538833, 0.69896195566, 0.759400245021 },
        { 0.81001154535, 0.700899671807, 0.751003475049 },
        { 0.816793551866, 0.702837387954, 0.742606705077 },
        { 0.823575558382, 0.704775104102, 0.734209935104 },
        { 0.830357564898, 0.706712820249, 0.725813165132 },
        { 0.837139571414, 0.708650536397, 0.717416395159 },
        { 0.84392157793, 0.710588252544, 0.709019625187 },
        { 0.850703584447, 0.712525968692, 0.700622855215 },
        { 0.857485590963, 0.714463684839, 0.692226085242 },
        { 0.864267597479, 0.716401400987, 0.68382931527 },
        { 0.871049603995, 0.718339117134, 0.675432545297 },
        { 0.877831610511, 0.720276833282, 0.667035775325 },
        { 0.884613617028, 0.722214549429, 0.658639005352 },
        { 0.891395623544, 0.724152265577, 0.65024223538 },
        { 0.89817763006, 0.726089981724, 0.641845465408 },
        { 0.904959636576, 0.728027697872, 0.633448695435 },
        { 0.911741643092, 0.729965414019, 0.625051925463 },
        { 0.918523649608, 0.731903130167, 0.61665515549 },
        { 0.925305656125, 0.733840846314, 0.608258385518 },
        { 0.932087662641, 0.735778562462, 0.599861615546 },
        { 0.938869669157, 0.737716278609, 0.591464845573 },
        { 0.945651675673, 0.739653994757, 0.583068075601 },
        { 0.952433682189, 0.741591710904, 0.574671305628 },
        { 0.959215688705, 0.743529427052, 0.566274535656 },
        { 0.965997695222, 0.745467143199, 0.557877765684 },
        { 0.972779701738, 0.747404859347, 0.549480995711 },
        { 0.979561708254, 0.749342575494, 0.541084225739 },
        { 0.98634371477, 0.751280291641, 0.532687455766 },
        { 0.992187620612, 0.75391004927, 0.525782419653 },
        { 0.992402922406, 0.760692055786, 0.527827786698 },
        { 0.9926182242, 0.767474062303, 0.529873153743 },
        { 0.992833525994, 0.774256068819, 0.531918520787 },
        { 0.993048827788, 0.781038075335, 0.533963887832 },
        { 0.993264129583, 0.787820081851, 0.536009254876 },
        { 0.993479431377, 0.794602088367, 0.538054621921 },
        { 0.993694733171, 0.801384094883, 0.540099988965 },
        { 0.993910034965, 0.8081661014, 0.54214535601 },
        { 0.994125336759, 0.814948107916, 0.544190723055 },
        { 0.994340638553, 0.821730114432, 0.546236090099 },
        { 0.994555940348, 0.828512120948, 0.548281457144 },
        { 0.994771242142, 0.835294127464, 0.550326824188 },
        { 0.994986543936, 0.84207613398, 0.552372191233 },
        { 0.99520184573, 0.848858140497, 0.554417558277 },
        { 0.995417147524, 0.855640147013, 0.556462925322 },
        { 0.995632449318, 0.862422153529, 0.558508292366 },
        { 0.995847751113, 0.869204160045, 0.560553659411 },
        { 0.996063052907, 0.875986166561, 0.562599026456 },
        { 0.996278354701, 0.882768173078, 0.5646443935 },
        { 0.996493656495, 0.889550179594, 0.566689760545 },
        { 0.996708958289, 0.89633218611, 0.568735127589 },
        { 0.996924260083, 0.903114192626, 0.570780494634 },
        { 0.997139561878, 0.909896199142, 0.572825861678 },
        { 0.997354863672, 0.916678205658, 0.574871228723 },
        { 0.997570165466, 0.923460212175, 0.576916595768 },
        { 0.99778546726, 0.930242218691, 0.578961962812 },
        { 0.998000769054, 0.937024225207, 0.581007329857 },
        { 0.998216070848, 0.943806231723, 0.583052696901 },
        { 0.998431372643, 0.950588238239, 0.585098063946 },
        { 0.998646674437, 0.957370244755, 0.58714343099 },
        { 0.998861976231, 0.964152251272, 0.589188798035 },
        { 0.999077278025, 0.970934257788, 0.591234165079 },
        { 0.999292579819, 0.977716264304, 0.593279532124 },
        { 0.999507881613, 0.98449827082, 0.595324899169 },
        { 0.999723183408, 0.991280277336, 0.597370266213 },
        { 0.999938485202, 0.998062283853, 0.599415633258 },
        { 0.984698193038, 0.988696655222, 0.601768574294 },
        { 0.963275663292, 0.972871972533, 0.604244544927 },
        { 0.941853133545, 0.957047289844, 0.60672051556 },
        { 0.920430603799, 0.941222607154, 0.609196486193 },
        { 0.899008074052, 0.925397924465, 0.611672456825 },
        { 0.877585544306, 0.909573241776, 0.614148427458 },
        { 0.856163014559, 0.893748559087, 0.616624398091 },
        { 0.834740484813, 0.877923876398, 0.619100368724 },
        { 0.813317955066, 0.862099193709, 0.621576339357 },
        { 0.79189542532, 0.846274511019, 0.62405230999 },
        { 0.770472895573, 0.83044982833, 0.626528280623 },
        { 0.749050365827, 0.814625145641, 0.629004251256 },
        { 0.72762783608, 0.798800462952, 0.631480221889 },
        { 0.706205306334, 0.782975780263, 0.633956192521 },
        { 0.684782776587, 0.767151097573, 0.636432163154 },
        { 0.663360246841, 0.751326414884, 0.638908133787 },
        { 0.641937717094, 0.735501732195, 0.64138410442 },
        { 0.620515187348, 0.719677049506, 0.643860075053 },
        { 0.599092657601, 0.703852366817, 0.646336045686 },
        { 0.577670127855, 0.688027684128, 0.648812016319 },
        { 0.556247598108, 0.672203001438, 0.651287986952 },
        { 0.534825068362, 0.656378318749, 0.653763957585 },
        { 0.513402538615, 0.64055363606, 0.656239928217 },
        { 0.491980008869, 0.624728953371, 0.65871589885 },
        { 0.470557479122, 0.608904270682, 0.661191869483 },
        { 0.449134949376, 0.593079587992, 0.663667840116 },
        { 0.427712419629, 0.577254905303, 0.666143810749 },
        { 0.406289889883, 0.561430222614, 0.668619781382 },
        { 0.384867360136, 0.545605539925, 0.671095752015 },
        { 0.36344483039, 0.529780857236, 0.673571722648 },
        { 0.342022300643, 0.513956174547, 0.676047693281 },
        { 0.320599770897, 0.498131491857, 0.678523663914 },
        { 0.29917724115, 0.482306809168, 0.680999634546 },
        { 0.277754711404, 0.466482126479, 0.683475605179 },
        { 0.256332181657, 0.45065744379, 0.685951575812 },
        { 0.234909651911, 0.434832761101, 0.688427546445 },
        { 0.225267206746, 0.420269131785, 0.688688984104 },
        { 0.245074973036, 0.408858135901, 0.683414089329 },
        { 0.264882739327, 0.397447140018, 0.678139194554 },
        { 0.284690505617, 0.386036144135, 0.672864299779 },
        { 0.304498271907, 0.374625148252, 0.667589405004 },
        { 0.324306038197, 0.363214152368, 0.662314510229 },
        { 0.344113804488, 0.351803156485, 0.657039615453 },
        { 0.363921570778, 0.340392160602, 0.651764720678 },
        { 0.383729337068, 0.328981164719, 0.646489825903 },
        { 0.403537103358, 0.317570168835, 0.641214931128 },
        { 0.423344869649, 0.306159172952, 0.635940036353 },
        { 0.443152635939, 0.294748177069, 0.630665141578 },
        { 0.462960402229, 0.283337181186, 0.625390246803 },
        { 0.48276816852, 0.271926185302, 0.620115352028 },
        { 0.50257593481, 0.260515189419, 0.614840457252 },
        { 0.5223837011, 0.249104193536, 0.609565562477 },
        { 0.54219146739, 0.237693197653, 0.604290667702 },
        { 0.561999233681, 0.226282201769, 0.599015772927 },
        { 0.581806999971, 0.214871205886, 0.593740878152 },
        { 0.601614766261, 0.203460210003, 0.588465983377 },
        { 0.621422532551, 0.19204921412, 0.583191088602 },
        { 0.641230298842, 0.180638218236, 0.577916193827 },
        { 0.661038065132, 0.169227222353, 0.572641299051 },
        { 0.680845831422, 0.15781622647, 0.567366404276 },
        { 0.700653597713, 0.146405230587, 0.562091509501 },
        { 0.720461364003, 0.134994234703, 0.556816614726 },
        { 0.740269130293, 0.12358323882, 0.551541719951 },
        { 0.760076896583, 0.112172242937, 0.546266825176 },
        { 0.779884662874, 0.100761247054, 0.540991930401 },
        { 0.799692429164, 0.0893502511705, 0.535717035625 },
        { 0.819500195454, 0.0779392552872, 0.53044214085 },
        { 0.839307961744, 0.066528259404, 0.525167246075 },
        { 0.859115728035, 0.0551172635208, 0.5198923513 },
        { 0.878923494325, 0.0437062676375, 0.514617456525 },
        { 0.898731260615, 0.0322952717543, 0.50934256175 },
        { 0.918539026906, 0.020884275871, 0.504067666975 },
        { 0.938346793196, 0.00947327998777, 0.4987927722 },
        { 0.936655136417, 0.0160553639755, 0.488442906737 },
        { 0.93138024246, 0.0256362946083, 0.477247212827 },
        { 0.926105348503, 0.0352172252412, 0.466051518917 },
        { 0.920830454546, 0.044798155874, 0.454855825007 },
        { 0.915555560589, 0.0543790865069, 0.443660131097 },
        { 0.910280666632, 0.0639600171397, 0.432464437187 },
        { 0.905005772675, 0.0735409477726, 0.421268743277 },
        { 0.899730878718, 0.0831218784054, 0.410073049366 },
        { 0.894455984761, 0.0927028090383, 0.398877355456 },
        { 0.889181090804, 0.102283739671, 0.387681661546 },
        { 0.883906196847, 0.111864670304, 0.376485967636 },
        { 0.87863130289, 0.121445600937, 0.365290273726 },
        { 0.873356408933, 0.13102653157, 0.354094579816 },
        { 0.868081514976, 0.140607462203, 0.342898885906 },
        { 0.862806621019, 0.150188392835, 0.331703191996 },
        { 0.857531727062, 0.159769323468, 0.320507498085 },
        { 0.852256833105, 0.169350254101, 0.309311804175 },
        { 0.846981939148, 0.178931184734, 0.298116110265 },
        { 0.84170704519, 0.188512115367, 0.286920416355 },
        { 0.836432151233, 0.198093046, 0.275724722445 },
        { 0.831157257276, 0.207673976632, 0.264529028535 },
        { 0.825882363319, 0.217254907265, 0.253333334625 },
        { 0.820607469362, 0.226835837898, 0.242137640715 },
        { 0.815332575405, 0.236416768531, 0.230941946805 },
        { 0.810057681448, 0.245997699164, 0.219746252894 },
        { 0.804782787491, 0.255578629797, 0.208550558984 },
        { 0.799507893534, 0.26515956043, 0.197354865074 },
        { 0.794232999577, 0.274740491062, 0.186159171164 },
        { 0.78895810562, 0.284321421695, 0.174963477254 },
        { 0.783683211663, 0.293902352328, 0.163767783344 },
        { 0.778408317706, 0.303483282961, 0.152572089434 },
        { 0.773133423749, 0.313064213594, 0.141376395524 },
        { 0.767858529792, 0.322645144227, 0.130180701613 },
        { 0.762583635835, 0.33222607486, 0.118985007703 },
        { 0.757308741878, 0.341807005492, 0.107789313793 },
        { 0.752033847921, 0.351387936125, 0.0965936198831 },
        { 0.744913509663, 0.357370250716, 0.09384083257 },
        { 0.735332579005, 0.358554410584, 0.102345254053 },
        { 0.725751648347, 0.359738570452, 0.110849675536 },
        { 0.716170717688, 0.36092273032, 0.119354097019 },
        { 0.70658978703, 0.362106890188, 0.127858518502 },
        { 0.697008856371, 0.363291050055, 0.136362939985 },
        { 0.687427925713, 0.364475209923, 0.144867361468 },
        { 0.677846995055, 0.365659369791, 0.153371782951 },
        { 0.668266064396, 0.366843529659, 0.161876204435 },
        { 0.658685133738, 0.368027689527, 0.170380625918 },
        { 0.649104203079, 0.369211849395, 0.178885047401 },
        { 0.639523272421, 0.370396009263, 0.187389468884 },
        { 0.629942341762, 0.371580169131, 0.195893890367 },
        { 0.620361411104, 0.372764328999, 0.20439831185 },
        { 0.610780480446, 0.373948488867, 0.212902733333 },
        { 0.601199549787, 0.375132648734, 0.221407154816 },
        { 0.591618619129, 0.376316808602, 0.229911576299 },
        { 0.58203768847, 0.37750096847, 0.238415997782 },
        { 0.572456757812, 0.378685128338, 0.246920419265 },
        { 0.562875827154, 0.379869288206, 0.255424840748 },
        { 0.553294896495, 0.381053448074, 0.263929262231 },
        { 0.543713965837, 0.382237607942, 0.272433683714 },
        { 0.534133035178, 0.38342176781, 0.280938105198 },
        { 0.52455210452, 0.384605927678, 0.289442526681 },
        { 0.514971173861, 0.385790087546, 0.297946948164 },
        { 0.505390243203, 0.386974247414, 0.306451369647 },
        { 0.495809312545, 0.388158407281, 0.31495579113 },
        { 0.486228381886, 0.389342567149, 0.323460212613 },
        { 0.476647451228, 0.390526727017, 0.331964634096 },
        { 0.467066520569, 0.391710886885, 0.340469055579 },
        { 0.457485589911, 0.392895046753, 0.348973477062 },
        { 0.447904659253, 0.394079206621, 0.357477898545 },
        { 0.438323728594, 0.395263366489, 0.365982320028 },
        { 0.428742797936, 0.396447526357, 0.374486741511 },
        { 0.419161867277, 0.397631686225, 0.382991162994 },
        { 0.409580936619, 0.398815846093, 0.391495584477 },
    };

    for (unsigned idx = 0; idx < 256; idx++)
    {
        mpDiscreteColorTransferFunction->AddRGBPoint(double(idx) / 255.0,
                                                     accent_colors[idx][0],
                                                     accent_colors[idx][1],
                                                     accent_colors[idx][2]);
    }

    mpScaleBar->SetOrientationToHorizontal();
    mpScaleBar->GetPositionCoordinate()->SetCoordinateSystemToNormalizedViewport();
    mpScaleBar->GetPositionCoordinate()->SetValue(0.25, 0.84);
    mpScaleBar->SetWidth(0.5);
    mpScaleBar->SetHeight(0.1);
    mpScaleBar->GetTitleTextProperty()->ItalicOff();
    mpScaleBar->GetLabelTextProperty()->ItalicOff();
    mpScaleBar->GetTitleTextProperty()->BoldOff();
    mpScaleBar->GetLabelTextProperty()->BoldOff();
    mpScaleBar->SetLabelFormat("%.2g");
    mpScaleBar->GetTitleTextProperty()->SetFontSize(5.0);
    mpScaleBar->GetLabelTextProperty()->SetFontSize(5.0);
    mpScaleBar->GetTitleTextProperty()->SetColor(0.0, 0.0, 0.0);
    mpScaleBar->GetLabelTextProperty()->SetColor(0.0, 0.0, 0.0);
}

template <unsigned DIM>
AbstractPyChasteActorGenerator<DIM>::~AbstractPyChasteActorGenerator()
{
}

template <unsigned DIM>
vtkSmartPointer<vtkColorTransferFunction> AbstractPyChasteActorGenerator<DIM>::GetColorTransferFunction()
{
    return mpColorTransferFunction;
}

template <unsigned DIM>
vtkSmartPointer<vtkScalarBarActor> AbstractPyChasteActorGenerator<DIM>::GetScaleBar()
{
    return mpScaleBar;
}

template <unsigned DIM>
vtkSmartPointer<vtkColorTransferFunction> AbstractPyChasteActorGenerator<DIM>::GetDiscreteColorTransferFunction()
{
    return mpDiscreteColorTransferFunction;
}

template <unsigned DIM>
void AbstractPyChasteActorGenerator<DIM>::SetShowEdges(bool show)
{
    mShowEdges = show;
}

template <unsigned DIM>
void AbstractPyChasteActorGenerator<DIM>::SetShowPoints(bool show)
{
    mShowPoints = show;
}

template <unsigned DIM>
void AbstractPyChasteActorGenerator<DIM>::SetPointSize(double size)
{
    mPointSize = size;
}

template <unsigned DIM>
void AbstractPyChasteActorGenerator<DIM>::SetEdgeSize(double size)
{
    mEdgeSize = size;
}

template <unsigned DIM>
void AbstractPyChasteActorGenerator<DIM>::SetShowScaleBar(double show)
{
    mShowScaleBar = show;
}

template <unsigned DIM>
void AbstractPyChasteActorGenerator<DIM>::SetShowVolume(bool show)
{
    mShowVolume = show;
}

template <unsigned DIM>
void AbstractPyChasteActorGenerator<DIM>::SetEdgeColor(const c_vector<double, 3>& rColor)
{
    mEdgeColor = rColor;
}

template <unsigned DIM>
void AbstractPyChasteActorGenerator<DIM>::SetPointColor(const c_vector<double, 3>& rColor)
{
    mPointColor = rColor;
}

template <unsigned DIM>
void AbstractPyChasteActorGenerator<DIM>::SetVolumeColor(const c_vector<double, 3>& rColor)
{
    mVolumeColor = rColor;
}

template <unsigned DIM>
void AbstractPyChasteActorGenerator<DIM>::SetVolumeOpacity(double opacity)
{
    mVolumeOpacity = opacity;
}

template <unsigned DIM>
void AbstractPyChasteActorGenerator<DIM>::SetDataLabel(const std::string& rLabel)
{
    mDataLabel = rLabel;
}

template class AbstractPyChasteActorGenerator<2>;
template class AbstractPyChasteActorGenerator<3>;
